
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/css/dashboards.css">
  <title>Dashboard - Time de Basquete</title>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body onload="iniciarDashboard()">
 

  <h1>Dashboard do Time</h1>

  <h2>Indicadores</h2>
<div id="indicadores" class="indicadores">
  <div id="indicador1" class="indicador">Jogadores: ...</div>
  <div id="indicador2" class="indicador">Treinos: ...</div>
  <div id="indicador3" class="indicador">Vit贸rias: ...</div>
  <div id="indicador4" class="indicador">Derrotas: ...</div>
</div>
  <h2>Desempenho (Vit贸rias x Derrotas)</h2>
  <canvas id="graficoDesempenho"></canvas>

  <h2>Treinos Totais</h2>
  <canvas id="graficoTreinosMes"></canvas>


<script>

var totalJogadores = 0;
var totalTreinos = 0;
var totalVitorias = 0;
var totalDerrotas = 0;


function iniciarDashboard() {
  obterTotalJogadores();
}

function obterTotalJogadores() {
  fetch("/jogador/total")
    .then(r => r.json())
    .then(json => {
      totalJogadores = json.totalJogadores;
      indicador1.innerHTML = `Jogadores: ${totalJogadores}`;
      obterTotalTreinos();
    });
}

function obterTotalTreinos() {
  fetch("/treino/total")
    .then(r => r.json())
    .then(json => {
      
      totalTreinos = json[0].totalTreinos;

      indicador2.innerHTML = `Treinos: ${totalTreinos}`;

      obterTotalVitorias();
      obterTotalJogos();
    }); }



function obterTotalVitorias() {
  fetch("/jogo/vitorias")
    .then(r => r.json())
    .then(json => {
      totalVitorias = json.totalVitorias;
      indicador3.innerHTML = `Vit贸rias: ${totalVitorias}`;
      obterTotalDerrotas();
    });
}

function obterTotalDerrotas() {
  fetch("/jogo/derrotas")
    .then(r => r.json())
    .then(json => {
      totalDerrotas = json.totalDerrotas;
      indicador4.innerHTML = `Derrotas: ${totalDerrotas}`;

      plotarGraficoDesempenho();
    });
}

function obterTotalJogos(){
  fetch("/jogo/total")
  .then(r => r.json())
  .then(json => {
    totalJogos = json.totalJogos;
  })
   plotarGraficoTreinos();
}


function plotarGraficoDesempenho() {
  var ctx = document.getElementById("graficoDesempenho").getContext("2d");

  new Chart(ctx, {
    type: "pie",
    data: {
      labels: ["Vit贸rias", "Derrotas"],
      datasets: [{
        data: [totalVitorias, totalDerrotas],
        backgroundColor: ["#4caf50", "#f44336"]
      }]
    }
  });
}

function plotarGraficoTreinos() {
  var ctx = document.getElementById("graficoTreinosMes").getContext("2d");

 
  new Chart(ctx, {
    type: "bar",
    data: {
      labels: ["Quantidade de treinos"],
      datasets: [{
        label: "Treinos",
        data: [totalTreinos],
        backgroundColor: "#2196f3"
      }]
    }
  });
}
</script>
</body>
</html>
